(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[458],{5546:function(t,n,i){var r,s;void 0!==(s="function"==typeof(r=function(){"use strict";function b(t,n){return void 0===n?n={autoBom:!1}:"object"!=typeof n&&(console.warn("Deprecated: Expected third argument to be a object"),n={autoBom:!n}),n.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\uFEFF",t],{type:t.type}):t}function c(t,n,i){var r=new XMLHttpRequest;r.open("GET",t),r.responseType="blob",r.onload=function(){s(r.response,n,i)},r.onerror=function(){console.error("could not download file")},r.send()}function d(t){var n=new XMLHttpRequest;n.open("HEAD",t,!1);try{n.send()}catch(t){}return 200<=n.status&&299>=n.status}function e(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(i){var n=document.createEvent("MouseEvents");n.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(n)}}var n="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof i.g&&i.g.global===i.g?i.g:void 0,r=n.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),s=n.saveAs||("object"!=typeof window||window!==n?function(){}:"download"in HTMLAnchorElement.prototype&&!r?function(t,i,r){var s=n.URL||n.webkitURL,o=document.createElement("a");i=i||t.name||"download",o.download=i,o.rel="noopener","string"==typeof t?(o.href=t,o.origin===location.origin?e(o):d(o.href)?c(t,i,r):e(o,o.target="_blank")):(o.href=s.createObjectURL(t),setTimeout(function(){s.revokeObjectURL(o.href)},4e4),setTimeout(function(){e(o)},0))}:"msSaveOrOpenBlob"in navigator?function(t,n,i){if(n=n||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(b(t,i),n);else if(d(t))c(t,n,i);else{var r=document.createElement("a");r.href=t,r.target="_blank",setTimeout(function(){e(r)})}}:function(t,i,s,o){if((o=o||open("","_blank"))&&(o.document.title=o.document.body.innerText="downloading..."),"string"==typeof t)return c(t,i,s);var a="application/octet-stream"===t.type,h=/constructor/i.test(n.HTMLElement)||n.safari,u=/CriOS\/[\d]+/.test(navigator.userAgent);if((u||a&&h||r)&&"undefined"!=typeof FileReader){var l=new FileReader;l.onloadend=function(){var t=l.result;t=u?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),o?o.location.href=t:location=t,o=null},l.readAsDataURL(t)}else{var p=n.URL||n.webkitURL,f=p.createObjectURL(t);o?o.location=f:location.href=f,o=null,setTimeout(function(){p.revokeObjectURL(f)},4e4)}});n.saveAs=s.saveAs=s,t.exports=s})?r.apply(n,[]):r)&&(t.exports=s)},1:function(t,n,i){var r=0/0,s=/^\s+|\s+$/g,o=/^[-+]0x[0-9a-f]+$/i,a=/^0b[01]+$/i,h=/^0o[0-7]+$/i,u=parseInt,l="object"==typeof i.g&&i.g&&i.g.Object===Object&&i.g,p="object"==typeof self&&self&&self.Object===Object&&self,f=l||p||Function("return this")(),g=Object.prototype.toString,y=Math.max,m=Math.min,now=function(){return f.Date.now()};function debounce(t,n,i){var r,s,o,a,h,u,l=0,p=!1,f=!1,g=!0;if("function"!=typeof t)throw TypeError("Expected a function");function invokeFunc(n){var i=r,o=s;return r=s=void 0,l=n,a=t.apply(o,i)}function leadingEdge(t){return l=t,h=setTimeout(timerExpired,n),p?invokeFunc(t):a}function remainingWait(t){var i=t-u,r=t-l,s=n-i;return f?m(s,o-r):s}function shouldInvoke(t){var i=t-u,r=t-l;return void 0===u||i>=n||i<0||f&&r>=o}function timerExpired(){var t=now();if(shouldInvoke(t))return trailingEdge(t);h=setTimeout(timerExpired,remainingWait(t))}function trailingEdge(t){return(h=void 0,g&&r)?invokeFunc(t):(r=s=void 0,a)}function cancel(){void 0!==h&&clearTimeout(h),l=0,r=u=s=h=void 0}function flush(){return void 0===h?a:trailingEdge(now())}function debounced(){var t=now(),i=shouldInvoke(t);if(r=arguments,s=this,u=t,i){if(void 0===h)return leadingEdge(u);if(f)return h=setTimeout(timerExpired,n),invokeFunc(u)}return void 0===h&&(h=setTimeout(timerExpired,n)),a}return n=toNumber(n)||0,isObject(i)&&(p=!!i.leading,o=(f="maxWait"in i)?y(toNumber(i.maxWait)||0,n):o,g="trailing"in i?!!i.trailing:g),debounced.cancel=cancel,debounced.flush=flush,debounced}function isObject(t){var n=typeof t;return!!t&&("object"==n||"function"==n)}function isObjectLike(t){return!!t&&"object"==typeof t}function isSymbol(t){return"symbol"==typeof t||isObjectLike(t)&&"[object Symbol]"==g.call(t)}function toNumber(t){if("number"==typeof t)return t;if(isSymbol(t))return r;if(isObject(t)){var n="function"==typeof t.valueOf?t.valueOf():t;t=isObject(n)?n+"":n}if("string"!=typeof t)return 0===t?t:+t;t=t.replace(s,"");var i=a.test(t);return i||h.test(t)?u(t.slice(2),i?2:8):o.test(t)?r:+t}t.exports=debounce},8447:function(t,n){"use strict";/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var i=Symbol.for("react.element"),r=Symbol.for("react.portal"),s=(Symbol.for("react.fragment"),Symbol.for("react.strict_mode"),Symbol.for("react.profiler"),Symbol.for("react.provider"),Symbol.for("react.context"),Symbol.for("react.forward_ref"),Symbol.for("react.suspense"),Symbol.for("react.memo"),Symbol.for("react.lazy"),Symbol.iterator);function A(t){return null===t||"object"!=typeof t?null:"function"==typeof(t=s&&t[s]||t["@@iterator"])?t:null}var o={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},a=Object.assign,h={};function E(t,n,i){this.props=t,this.context=n,this.refs=h,this.updater=i||o}function F(){}function G(t,n,i){this.props=t,this.context=n,this.refs=h,this.updater=i||o}E.prototype.isReactComponent={},E.prototype.setState=function(t,n){if("object"!=typeof t&&"function"!=typeof t&&null!=t)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,n,"setState")},E.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},F.prototype=E.prototype;var u=G.prototype=new F;u.constructor=G,a(u,E.prototype),u.isPureReactComponent=!0;var l=Array.isArray;function N(t,n){return{$$typeof:i,type:t.type,key:n,ref:t.ref,props:t.props,_owner:t._owner}}function O(t){return"object"==typeof t&&null!==t&&t.$$typeof===i}function escape(t){var n={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(t){return n[t]})}Object.prototype.hasOwnProperty;var p=/\/+/g;function Q(t,n){return"object"==typeof t&&null!==t&&null!=t.key?escape(""+t.key):n.toString(36)}var f={current:null};n.useCallback=function(t,n){return f.current.useCallback(t,n)},n.useEffect=function(t,n){return f.current.useEffect(t,n)},n.useReducer=function(t,n,i){return f.current.useReducer(t,n,i)},n.useRef=function(t){return f.current.useRef(t)},n.useState=function(t){return f.current.useState(t)}},2735:function(t,n,i){"use strict";t.exports=i(8447)},9008:function(t,n,i){t.exports=i(9201)},1141:function(t){var n,i,r,s=t.exports={};function defaultSetTimout(){throw Error("setTimeout has not been defined")}function defaultClearTimeout(){throw Error("clearTimeout has not been defined")}function runTimeout(t){if(n===setTimeout)return setTimeout(t,0);if((n===defaultSetTimout||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(i){try{return n.call(null,t,0)}catch(i){return n.call(this,t,0)}}}function runClearTimeout(t){if(i===clearTimeout)return clearTimeout(t);if((i===defaultClearTimeout||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{return i(t)}catch(n){try{return i.call(null,t)}catch(n){return i.call(this,t)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(t){n=defaultSetTimout}try{i="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(t){i=defaultClearTimeout}}();var o=[],a=!1,h=-1;function cleanUpNextTick(){a&&r&&(a=!1,r.length?o=r.concat(o):h=-1,o.length&&drainQueue())}function drainQueue(){if(!a){var t=runTimeout(cleanUpNextTick);a=!0;for(var n=o.length;n;){for(r=o,o=[];++h<n;)r&&r[h].run();h=-1,n=o.length}r=null,a=!1,runClearTimeout(t)}}function Item(t,n){this.fun=t,this.array=n}function noop(){}s.nextTick=function(t){var n=Array(arguments.length-1);if(arguments.length>1)for(var i=1;i<arguments.length;i++)n[i-1]=arguments[i];o.push(new Item(t,n)),1!==o.length||a||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=noop,s.addListener=noop,s.once=noop,s.off=noop,s.removeListener=noop,s.removeAllListeners=noop,s.emit=noop,s.prependListener=noop,s.prependOnceListener=noop,s.listeners=function(t){return[]},s.binding=function(t){throw Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw Error("process.chdir is not supported")},s.umask=function(){return 0}},4820:function(t,n,i){"use strict";let r;function asyncGeneratorStep(t,n,i,r,s,o,a){try{var h=t[o](a),u=h.value}catch(t){i(t);return}h.done?n(u):Promise.resolve(u).then(r,s)}function _async_to_generator(t){return function(){var n=this,i=arguments;return new Promise(function(r,s){var o=t.apply(n,i);function _next(t){asyncGeneratorStep(o,r,s,_next,_throw,"next",t)}function _throw(t){asyncGeneratorStep(o,r,s,_next,_throw,"throw",t)}_next(void 0)})}}i.d(n,{Z:function(){return v},x:function(){return useSpeechRecognition}});var s=i(2735),o=i(1);let a="undefined"!=typeof window&&(window.SpeechRecognition||window.webkitSpeechRecognition||window.mozSpeechRecognition||window.msSpeechRecognition||window.oSpeechRecognition),isNative=t=>t===a;var isAndroid=()=>/(android)/i.test("undefined"!=typeof navigator?navigator.userAgent:"");let concatTranscripts=(...t)=>t.map(t=>t.trim()).join(" ").trim(),h=/\s*\((.*?)\)\s*/g,u=/(\(\?:[^)]+\))\?/g,l=/(\(\?)?:\w+/g,p=/\*/g,f=/[-{}[\]+?.,\\^$|#]/g,commandToRegExp=t=>t instanceof RegExp?RegExp(t.source,"i"):RegExp("^"+(t=t.replace(f,"\\$&").replace(h,"(?:$1)?").replace(l,(t,n)=>n?t:"([^\\s]+)").replace(p,"(.*?)").replace(u,"\\s*$1?\\s*"))+"$","i"),compareTwoStringsUsingDiceCoefficient=(t,n)=>{if(t=t.replace(/\s+/g,"").toLowerCase(),n=n.replace(/\s+/g,"").toLowerCase(),!t.length&&!n.length)return 1;if(!t.length||!n.length)return 0;if(t===n)return 1;if(1===t.length&&1===n.length||t.length<2||n.length<2)return 0;let i=new Map;for(let n=0;n<t.length-1;n++){let r=t.substring(n,n+2),s=i.has(r)?i.get(r)+1:1;i.set(r,s)}let r=0;for(let t=0;t<n.length-1;t++){let s=n.substring(t,t+2),o=i.has(s)?i.get(s):0;o>0&&(i.set(s,o-1),r++)}return 2*r/(t.length+n.length-2)},browserSupportsPolyfills=()=>"undefined"!=typeof window&&void 0!==window.navigator&&void 0!==window.navigator.mediaDevices&&void 0!==window.navigator.mediaDevices.getUserMedia&&(void 0!==window.AudioContext||void 0!==window.webkitAudioContext);let RecognitionManager=class RecognitionManager{setSpeechRecognition(t){let n=!!t&&(isNative(t)||browserSupportsPolyfills());n&&(this.disableRecognition(),this.recognition=new t,this.recognition.continuous=!1,this.recognition.interimResults=!0,this.recognition.onresult=this.updateTranscript.bind(this),this.recognition.onend=this.onRecognitionDisconnect.bind(this),this.recognition.onerror=this.onError.bind(this)),this.emitBrowserSupportsSpeechRecognitionChange(n)}subscribe(t,n){this.subscribers[t]=n}unsubscribe(t){delete this.subscribers[t]}emitListeningChange(t){this.listening=t,Object.keys(this.subscribers).forEach(n=>{let{onListeningChange:i}=this.subscribers[n];i(t)})}emitMicrophoneAvailabilityChange(t){this.isMicrophoneAvailable=t,Object.keys(this.subscribers).forEach(n=>{let{onMicrophoneAvailabilityChange:i}=this.subscribers[n];i(t)})}emitTranscriptChange(t,n){Object.keys(this.subscribers).forEach(i=>{let{onTranscriptChange:r}=this.subscribers[i];r(t,n)})}emitClearTranscript(){Object.keys(this.subscribers).forEach(t=>{let{onClearTranscript:n}=this.subscribers[t];n()})}emitBrowserSupportsSpeechRecognitionChange(t){Object.keys(this.subscribers).forEach(n=>{let{onBrowserSupportsSpeechRecognitionChange:i,onBrowserSupportsContinuousListeningChange:r}=this.subscribers[n];i(t),r(t)})}disconnect(t){if(this.recognition&&this.listening)switch(t){case"ABORT":this.pauseAfterDisconnect=!0,this.abort();break;case"RESET":this.pauseAfterDisconnect=!1,this.abort();break;default:this.pauseAfterDisconnect=!0,this.stop()}}disableRecognition(){this.recognition&&(this.recognition.onresult=()=>{},this.recognition.onend=()=>{},this.recognition.onerror=()=>{},this.listening&&this.stopListening())}onError(t){t&&t.error&&"not-allowed"===t.error&&(this.emitMicrophoneAvailabilityChange(!1),this.disableRecognition())}onRecognitionDisconnect(){this.onStopListening(),this.listening=!1,this.pauseAfterDisconnect?this.emitListeningChange(!1):this.recognition&&(this.recognition.continuous?this.startListening({continuous:this.recognition.continuous}):this.emitListeningChange(!1)),this.pauseAfterDisconnect=!1}updateTranscript({results:t,resultIndex:n}){let i=void 0===n?t.length-1:n;this.interimTranscript="",this.finalTranscript="";for(let n=i;n<t.length;++n)t[n].isFinal&&(!isAndroid()||t[n][0].confidence>0)?this.updateFinalTranscript(t[n][0].transcript):this.interimTranscript=concatTranscripts(this.interimTranscript,t[n][0].transcript);let r=!1;""===this.interimTranscript&&""!==this.finalTranscript?(this.previousResultWasFinalOnly&&(r=!0),this.previousResultWasFinalOnly=!0):this.previousResultWasFinalOnly=!1,r||this.emitTranscriptChange(this.interimTranscript,this.finalTranscript)}updateFinalTranscript(t){this.finalTranscript=concatTranscripts(this.finalTranscript,t)}resetTranscript(){this.disconnect("RESET")}startListening(){return _async_to_generator(function*({continuous:t=!1,language:n}={}){if(!this.recognition)return;let i=t!==this.recognition.continuous,r=n&&n!==this.recognition.lang;if((i||r)&&(this.listening&&(yield this.stopListening()),this.recognition.continuous=i?t:this.recognition.continuous,this.recognition.lang=r?n:this.recognition.lang),!this.listening){this.recognition.continuous||(this.resetTranscript(),this.emitClearTranscript());try{yield this.start(),this.emitListeningChange(!0)}catch(t){t instanceof DOMException||this.emitMicrophoneAvailabilityChange(!1)}}}).apply(this,arguments)}abortListening(){return _async_to_generator(function*(){this.disconnect("ABORT"),this.emitListeningChange(!1),yield new Promise(t=>{this.onStopListening=t})}).call(this)}stopListening(){return _async_to_generator(function*(){this.disconnect("STOP"),this.emitListeningChange(!1),yield new Promise(t=>{this.onStopListening=t})}).call(this)}getRecognition(){return this.recognition}start(){return _async_to_generator(function*(){this.recognition&&!this.listening&&(yield this.recognition.start(),this.listening=!0)}).call(this)}stop(){this.recognition&&this.listening&&(this.recognition.stop(),this.listening=!1)}abort(){this.recognition&&this.listening&&(this.recognition.abort(),this.listening=!1)}constructor(t){this.recognition=null,this.pauseAfterDisconnect=!1,this.interimTranscript="",this.finalTranscript="",this.listening=!1,this.isMicrophoneAvailable=!0,this.subscribers={},this.onStopListening=()=>{},this.previousResultWasFinalOnly=!1,this.resetTranscript=this.resetTranscript.bind(this),this.startListening=this.startListening.bind(this),this.stopListening=this.stopListening.bind(this),this.abortListening=this.abortListening.bind(this),this.setSpeechRecognition=this.setSpeechRecognition.bind(this),this.disableRecognition=this.disableRecognition.bind(this),this.setSpeechRecognition(t),isAndroid()&&(this.updateFinalTranscript=o(this.updateFinalTranscript,250,{leading:!0}))}};let g="CLEAR_TRANSCRIPT",y="APPEND_TRANSCRIPT",clearTranscript=()=>({type:g}),appendTranscript=(t,n)=>({type:y,payload:{interimTranscript:t,finalTranscript:n}}),transcriptReducer=(t,n)=>{switch(n.type){case g:return{interimTranscript:"",finalTranscript:""};case y:return{interimTranscript:n.payload.interimTranscript,finalTranscript:concatTranscripts(t.finalTranscript,n.payload.finalTranscript)};default:throw Error()}},m=!!a,_=m&&!isAndroid(),useSpeechRecognition=({transcribing:t=!0,clearTranscriptOnListen:n=!0,commands:i=[]}={})=>{let[r]=(0,s.useState)(v.getRecognitionManager()),[o,a]=(0,s.useState)(m),[h,u]=(0,s.useState)(_),[{interimTranscript:l,finalTranscript:p},f]=(0,s.useReducer)(transcriptReducer,{interimTranscript:r.interimTranscript,finalTranscript:""}),[g,y]=(0,s.useState)(r.listening),[w,k]=(0,s.useState)(r.isMicrophoneAvailable),T=(0,s.useRef)(i);T.current=i;let dispatchClearTranscript=()=>{f(clearTranscript())},R=(0,s.useCallback)(()=>{r.resetTranscript(),dispatchClearTranscript()},[r]),testFuzzyMatch=(t,n,i)=>{let r="object"==typeof t?t.toString():t,s=r.replace(/[&/\\#,+()!$~%.'":*?<>{}]/g,"").replace(/  +/g," ").trim(),o=compareTwoStringsUsingDiceCoefficient(s,n);return o>=i?{command:t,commandWithoutSpecials:s,howSimilar:o,isFuzzyMatch:!0}:null},testMatch=(t,n)=>{let i=commandToRegExp(t),r=i.exec(n);return r?{command:t,parameters:r.slice(1)}:null},S=(0,s.useCallback)((t,n)=>{T.current.forEach(({command:i,callback:r,matchInterim:s=!1,isFuzzyMatch:o=!1,fuzzyMatchingThreshold:a=.8,bestMatchOnly:h=!1})=>{let u=!n&&s?t.trim():n.trim(),l=Array.isArray(i)?i:[i],p=l.map(t=>o?testFuzzyMatch(t,u,a):testMatch(t,u)).filter(t=>t);if(o&&h&&p.length>=2){p.sort((t,n)=>n.howSimilar-t.howSimilar);let{command:t,commandWithoutSpecials:n,howSimilar:i}=p[0];r(n,u,i,{command:t,resetTranscript:R})}else p.forEach(t=>{if(t.isFuzzyMatch){let{command:n,commandWithoutSpecials:i,howSimilar:s}=t;r(i,u,s,{command:n,resetTranscript:R})}else{let{command:n,parameters:i}=t;r(...i,{command:n,resetTranscript:R})}})})},[R]),C=(0,s.useCallback)((n,i)=>{t&&f(appendTranscript(n,i)),S(n,i)},[S,t]),B=(0,s.useCallback)(()=>{n&&dispatchClearTranscript()},[n]);(0,s.useEffect)(()=>{let t=v.counter;return v.counter+=1,r.subscribe(t,{onListeningChange:y,onMicrophoneAvailabilityChange:k,onTranscriptChange:C,onClearTranscript:B,onBrowserSupportsSpeechRecognitionChange:a,onBrowserSupportsContinuousListeningChange:u}),()=>{r.unsubscribe(t)}},[t,n,r,C,B]);let L=concatTranscripts(p,l);return{transcript:L,interimTranscript:l,finalTranscript:p,listening:g,isMicrophoneAvailable:w,resetTranscript:R,browserSupportsSpeechRecognition:o,browserSupportsContinuousListening:h}},v={counter:0,applyPolyfill:t=>{r?r.setSpeechRecognition(t):r=new RecognitionManager(t);let n=!!t&&browserSupportsPolyfills();m=n,_=n},removePolyfill:()=>{r?r.setSpeechRecognition(a):r=new RecognitionManager(a),_=(m=!!a)&&!isAndroid()},getRecognitionManager:()=>(r||(r=new RecognitionManager(a)),r),getRecognition:()=>{let t=v.getRecognitionManager();return t.getRecognition()},startListening:({continuous:t,language:n}={})=>_async_to_generator(function*(){let i=v.getRecognitionManager();yield i.startListening({continuous:t,language:n})})(),stopListening:()=>_async_to_generator(function*(){let t=v.getRecognitionManager();yield t.stopListening()})(),abortListening:()=>_async_to_generator(function*(){let t=v.getRecognitionManager();yield t.abortListening()})(),browserSupportsSpeechRecognition:()=>m,browserSupportsContinuousListening:()=>_}},6515:function(t,n,i){"use strict";let r,s;i.d(n,{io:function(){return esm_lookup}});var o,a,h={};i.r(h),i.d(h,{Decoder:function(){return Decoder},Encoder:function(){return Encoder},PacketType:function(){return a},protocol:function(){return V}});let u=Object.create(null);u.open="0",u.close="1",u.ping="2",u.pong="3",u.message="4",u.upgrade="5",u.noop="6";let l=Object.create(null);Object.keys(u).forEach(t=>{l[u[t]]=t});let p={type:"error",data:"parser error"},f="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),g="function"==typeof ArrayBuffer,isView=t=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,encodePacket=({type:t,data:n},i,r)=>f&&n instanceof Blob?i?r(n):encodeBlobAsBase64(n,r):g&&(n instanceof ArrayBuffer||isView(n))?i?r(n):encodeBlobAsBase64(new Blob([n]),r):r(u[t]+(n||"")),encodeBlobAsBase64=(t,n)=>{let i=new FileReader;return i.onload=function(){let t=i.result.split(",")[1];n("b"+(t||""))},i.readAsDataURL(t)};function toArray(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}function encodePacketToBinary(t,n){return f&&t.data instanceof Blob?t.data.arrayBuffer().then(toArray).then(n):g&&(t.data instanceof ArrayBuffer||isView(t.data))?n(toArray(t.data)):void encodePacket(t,!1,t=>{r||(r=new TextEncoder),n(r.encode(t))})}let y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",m="undefined"==typeof Uint8Array?[]:new Uint8Array(256);for(let t=0;t<y.length;t++)m[y.charCodeAt(t)]=t;let decode=t=>{let n=.75*t.length,i=t.length,r,s=0,o,a,h,u;"="===t[t.length-1]&&(n--,"="===t[t.length-2]&&n--);let l=new ArrayBuffer(n),p=new Uint8Array(l);for(r=0;r<i;r+=4)o=m[t.charCodeAt(r)],a=m[t.charCodeAt(r+1)],h=m[t.charCodeAt(r+2)],u=m[t.charCodeAt(r+3)],p[s++]=o<<2|a>>4,p[s++]=(15&a)<<4|h>>2,p[s++]=(3&h)<<6|63&u;return l},_="function"==typeof ArrayBuffer,decodePacket=(t,n)=>{if("string"!=typeof t)return{type:"message",data:mapBinary(t,n)};let i=t.charAt(0);if("b"===i)return{type:"message",data:decodeBase64Packet(t.substring(1),n)};let r=l[i];return r?t.length>1?{type:l[i],data:t.substring(1)}:{type:l[i]}:p},decodeBase64Packet=(t,n)=>{if(!_)return{base64:!0,data:t};{let i=decode(t);return mapBinary(i,n)}},mapBinary=(t,n)=>"blob"===n?t instanceof Blob?t:new Blob([t]):t instanceof ArrayBuffer?t:t.buffer,encodePayload=(t,n)=>{let i=t.length,r=Array(i),s=0;t.forEach((t,o)=>{encodePacket(t,!1,t=>{r[o]=t,++s===i&&n(r.join("\x1e"))})})},decodePayload=(t,n)=>{let i=t.split("\x1e"),r=[];for(let t=0;t<i.length;t++){let s=decodePacket(i[t],n);if(r.push(s),"error"===s.type)break}return r};function createPacketEncoderStream(){return new TransformStream({transform(t,n){encodePacketToBinary(t,i=>{let r;let s=i.length;if(s<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,s);else if(s<65536){r=new Uint8Array(3);let t=new DataView(r.buffer);t.setUint8(0,126),t.setUint16(1,s)}else{r=new Uint8Array(9);let t=new DataView(r.buffer);t.setUint8(0,127),t.setBigUint64(1,BigInt(s))}t.data&&"string"!=typeof t.data&&(r[0]|=128),n.enqueue(r),n.enqueue(i)})}})}function totalLength(t){return t.reduce((t,n)=>t+n.length,0)}function concatChunks(t,n){if(t[0].length===n)return t.shift();let i=new Uint8Array(n),r=0;for(let s=0;s<n;s++)i[s]=t[0][r++],r===t[0].length&&(t.shift(),r=0);return t.length&&r<t[0].length&&(t[0]=t[0].slice(r)),i}function createPacketDecoderStream(t,n){s||(s=new TextDecoder);let i=[],r=0,o=-1,a=!1;return new TransformStream({transform(h,u){for(i.push(h);;){if(0===r){if(1>totalLength(i))break;let t=concatChunks(i,1);a=(128&t[0])==128,r=(o=127&t[0])<126?3:126===o?1:2}else if(1===r){if(2>totalLength(i))break;let t=concatChunks(i,2);o=new DataView(t.buffer,t.byteOffset,t.length).getUint16(0),r=3}else if(2===r){if(8>totalLength(i))break;let t=concatChunks(i,8),n=new DataView(t.buffer,t.byteOffset,t.length),s=n.getUint32(0);if(s>2097151){u.enqueue(p);break}o=4294967296*s+n.getUint32(4),r=3}else{if(totalLength(i)<o)break;let t=concatChunks(i,o);u.enqueue(decodePacket(a?t:s.decode(t),n)),r=0}if(0===o||o>t){u.enqueue(p);break}}}})}function Emitter(t){if(t)return mixin(t)}function mixin(t){for(var n in Emitter.prototype)t[n]=Emitter.prototype[n];return t}Emitter.prototype.on=Emitter.prototype.addEventListener=function(t,n){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(n),this},Emitter.prototype.once=function(t,n){function on(){this.off(t,on),n.apply(this,arguments)}return on.fn=n,this.on(t,on),this},Emitter.prototype.off=Emitter.prototype.removeListener=Emitter.prototype.removeAllListeners=Emitter.prototype.removeEventListener=function(t,n){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var i,r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var s=0;s<r.length;s++)if((i=r[s])===n||i.fn===n){r.splice(s,1);break}return 0===r.length&&delete this._callbacks["$"+t],this},Emitter.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var n=Array(arguments.length-1),i=this._callbacks["$"+t],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if(i){i=i.slice(0);for(var r=0,s=i.length;r<s;++r)i[r].apply(this,n)}return this},Emitter.prototype.emitReserved=Emitter.prototype.emit,Emitter.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},Emitter.prototype.hasListeners=function(t){return!!this.listeners(t).length};let v=(()=>{let t="function"==typeof Promise&&"function"==typeof Promise.resolve;return t?t=>Promise.resolve().then(t):(t,n)=>n(t,0)})(),w="undefined"!=typeof self?self:"undefined"!=typeof window?window:Function("return this")();function createCookieJar(){}function pick(t,...n){return n.reduce((n,i)=>(t.hasOwnProperty(i)&&(n[i]=t[i]),n),{})}let k=w.setTimeout,T=w.clearTimeout;function installTimerFunctions(t,n){n.useNativeTimers?(t.setTimeoutFn=k.bind(w),t.clearTimeoutFn=T.bind(w)):(t.setTimeoutFn=w.setTimeout.bind(w),t.clearTimeoutFn=w.clearTimeout.bind(w))}function byteLength(t){return"string"==typeof t?utf8Length(t):Math.ceil(1.33*(t.byteLength||t.size))}function utf8Length(t){let n=0,i=0;for(let r=0,s=t.length;r<s;r++)(n=t.charCodeAt(r))<128?i+=1:n<2048?i+=2:n<55296||n>=57344?i+=3:(r++,i+=4);return i}function randomString(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function parseqs_encode(t){let n="";for(let i in t)t.hasOwnProperty(i)&&(n.length&&(n+="&"),n+=encodeURIComponent(i)+"="+encodeURIComponent(t[i]));return n}function parseqs_decode(t){let n={},i=t.split("&");for(let t=0,r=i.length;t<r;t++){let r=i[t].split("=");n[decodeURIComponent(r[0])]=decodeURIComponent(r[1])}return n}let TransportError=class TransportError extends Error{constructor(t,n,i){super(t),this.description=n,this.context=i,this.type="TransportError"}};let Transport=class Transport extends Emitter{constructor(t){super(),this.writable=!1,installTimerFunctions(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,n,i){return super.emitReserved("error",new TransportError(t,n,i)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return("opening"===this.readyState||"open"===this.readyState)&&(this.doClose(),this.onClose()),this}send(t){"open"===this.readyState&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){let n=decodePacket(t,this.socket.binaryType);this.onPacket(n)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,n={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(n)}_hostname(){let t=this.opts.hostname;return -1===t.indexOf(":")?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&Number(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(t){let n=parseqs_encode(t);return n.length?"?"+n:""}};let polling_Polling=class polling_Polling extends Transport{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";let pause=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let t=0;this._polling&&(t++,this.once("pollComplete",function(){--t||pause()})),this.writable||(t++,this.once("drain",function(){--t||pause()}))}else pause()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){decodePayload(t,this.socket.binaryType).forEach(t=>{if("opening"===this.readyState&&"open"===t.type&&this.onOpen(),"close"===t.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(t)}),"closed"!==this.readyState&&(this._polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this._poll())}doClose(){let close=()=>{this.write([{type:"close"}])};"open"===this.readyState?close():this.once("open",close)}write(t){this.writable=!1,encodePayload(t,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let t=this.opts.secure?"https":"http",n=this.query||{};return!1!==this.opts.timestampRequests&&(n[this.opts.timestampParam]=randomString()),this.supportsBinary||n.sid||(n.b64=1),this.createUri(t,n)}};let R=!1;try{R="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(t){}let S=R;function empty(){}let BaseXHR=class BaseXHR extends polling_Polling{constructor(t){if(super(t),"undefined"!=typeof location){let n="https:"===location.protocol,i=location.port;i||(i=n?"443":"80"),this.xd="undefined"!=typeof location&&t.hostname!==location.hostname||i!==t.port}}doWrite(t,n){let i=this.request({method:"POST",data:t});i.on("success",n),i.on("error",(t,n)=>{this.onError("xhr post error",t,n)})}doPoll(){let t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(t,n)=>{this.onError("xhr poll error",t,n)}),this.pollXhr=t}};let Request=class Request extends Emitter{constructor(t,n,i){super(),this.createRequest=t,installTimerFunctions(this,i),this._opts=i,this._method=i.method||"GET",this._uri=n,this._data=void 0!==i.data?i.data:null,this._create()}_create(){var t;let n=pick(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");n.xdomain=!!this._opts.xd;let i=this._xhr=this.createRequest(n);try{i.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders)for(let t in i.setDisableHeaderCheck&&i.setDisableHeaderCheck(!0),this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(t)&&i.setRequestHeader(t,this._opts.extraHeaders[t])}catch(t){}if("POST"===this._method)try{i.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(t){}try{i.setRequestHeader("Accept","*/*")}catch(t){}null===(t=this._opts.cookieJar)||void 0===t||t.addCookies(i),"withCredentials"in i&&(i.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(i.timeout=this._opts.requestTimeout),i.onreadystatechange=()=>{var t;3===i.readyState&&(null===(t=this._opts.cookieJar)||void 0===t||t.parseCookies(i.getResponseHeader("set-cookie"))),4===i.readyState&&(200===i.status||1223===i.status?this._onLoad():this.setTimeoutFn(()=>{this._onError("number"==typeof i.status?i.status:0)},0))},i.send(this._data)}catch(t){this.setTimeoutFn(()=>{this._onError(t)},0);return}"undefined"!=typeof document&&(this._index=Request.requestsCount++,Request.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(void 0!==this._xhr&&null!==this._xhr){if(this._xhr.onreadystatechange=empty,t)try{this._xhr.abort()}catch(t){}"undefined"!=typeof document&&delete Request.requests[this._index],this._xhr=null}}_onLoad(){let t=this._xhr.responseText;null!==t&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}};if(Request.requestsCount=0,Request.requests={},"undefined"!=typeof document){if("function"==typeof attachEvent)attachEvent("onunload",unloadHandler);else if("function"==typeof addEventListener){let t="onpagehide"in w?"pagehide":"unload";addEventListener(t,unloadHandler,!1)}}function unloadHandler(){for(let t in Request.requests)Request.requests.hasOwnProperty(t)&&Request.requests[t].abort()}let C=function(){let t=newRequest({xdomain:!1});return t&&null!==t.responseType}();let XHR=class XHR extends BaseXHR{constructor(t){super(t);let n=t&&t.forceBase64;this.supportsBinary=C&&!n}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new Request(newRequest,this.uri(),t)}};function newRequest(t){let n=t.xdomain;try{if("undefined"!=typeof XMLHttpRequest&&(!n||S))return new XMLHttpRequest}catch(t){}if(!n)try{return new w[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch(t){}}let B="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase();let BaseWS=class BaseWS extends Transport{get name(){return"websocket"}doOpen(){let t=this.uri(),n=this.opts.protocols,i=B?{}:pick(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(i.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,n,i)}catch(t){return this.emitReserved("error",t)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let n=0;n<t.length;n++){let i=t[n],r=n===t.length-1;encodePacket(i,this.supportsBinary,t=>{try{this.doWrite(i,t)}catch(t){}r&&v(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){void 0!==this.ws&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){let t=this.opts.secure?"wss":"ws",n=this.query||{};return this.opts.timestampRequests&&(n[this.opts.timestampParam]=randomString()),this.supportsBinary||(n.b64=1),this.createUri(t,n)}};let L=w.WebSocket||w.MozWebSocket;let WS=class WS extends BaseWS{createSocket(t,n,i){return B?new L(t,n,i):n?new L(t,n):new L(t)}doWrite(t,n){this.ws.send(n)}};let WT=class WT extends Transport{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{let n=createPacketDecoderStream(Number.MAX_SAFE_INTEGER,this.socket.binaryType),i=t.readable.pipeThrough(n).getReader(),r=createPacketEncoderStream();r.readable.pipeTo(t.writable),this._writer=r.writable.getWriter();let read=()=>{i.read().then(({done:t,value:n})=>{t||(this.onPacket(n),read())}).catch(t=>{})};read();let s={type:"open"};this.query.sid&&(s.data=`{"sid":"${this.query.sid}"}`),this._writer.write(s).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let n=0;n<t.length;n++){let i=t[n],r=n===t.length-1;this._writer.write(i).then(()=>{r&&v(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;null===(t=this._transport)||void 0===t||t.close()}};let x={websocket:WS,webtransport:WT,polling:XHR},P=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,j=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function parse(t){if(t.length>8e3)throw"URI too long";let n=t,i=t.indexOf("["),r=t.indexOf("]");-1!=i&&-1!=r&&(t=t.substring(0,i)+t.substring(i,r).replace(/:/g,";")+t.substring(r,t.length));let s=P.exec(t||""),o={},a=14;for(;a--;)o[j[a]]=s[a]||"";return -1!=i&&-1!=r&&(o.source=n,o.host=o.host.substring(1,o.host.length-1).replace(/;/g,":"),o.authority=o.authority.replace("[","").replace("]","").replace(/;/g,":"),o.ipv6uri=!0),o.pathNames=pathNames(o,o.path),o.queryKey=queryKey(o,o.query),o}function pathNames(t,n){let i=n.replace(/\/{2,9}/g,"/").split("/");return("/"==n.slice(0,1)||0===n.length)&&i.splice(0,1),"/"==n.slice(-1)&&i.splice(i.length-1,1),i}function queryKey(t,n){let i={};return n.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(t,n,r){n&&(i[n]=r)}),i}let q="function"==typeof addEventListener&&"function"==typeof removeEventListener,U=[];q&&addEventListener("offline",()=>{U.forEach(t=>t())},!1);let SocketWithoutUpgrade=class SocketWithoutUpgrade extends Emitter{constructor(t,n){if(super(),this.binaryType="arraybuffer",this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&"object"==typeof t&&(n=t,t=null),t){let i=parse(t);n.hostname=i.host,n.secure="https"===i.protocol||"wss"===i.protocol,n.port=i.port,i.query&&(n.query=i.query)}else n.host&&(n.hostname=parse(n.host).host);installTimerFunctions(this,n),this.secure=null!=n.secure?n.secure:"undefined"!=typeof location&&"https:"===location.protocol,n.hostname&&!n.port&&(n.port=this.secure?"443":"80"),this.hostname=n.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=n.port||("undefined"!=typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},n.transports.forEach(t=>{let n=t.prototype.name;this.transports.push(n),this._transportsByName[n]=t}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},n),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=parseqs_decode(this.opts.query)),q&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},U.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=createCookieJar()),this._open()}createTransport(t){let n=Object.assign({},this.opts.query);n.EIO=4,n.transport=t,this.id&&(n.sid=this.id);let i=Object.assign({},this.opts,{query:n,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](i)}_open(){if(0===this.transports.length){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}let t=this.opts.rememberUpgrade&&SocketWithoutUpgrade.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket")?"websocket":this.transports[0];this.readyState="opening";let n=this.createTransport(t);n.open(),this.setTransport(n)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",t=>this._onClose("transport close",t))}onOpen(){this.readyState="open",SocketWithoutUpgrade.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush()}_onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":let n=Error("server error");n.code=t.data,this._onError(n);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data)}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),"closed"!==this.readyState&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);let t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){let t=this._maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1;if(!t)return this.writeBuffer;let n=1;for(let t=0;t<this.writeBuffer.length;t++){let i=this.writeBuffer[t].data;if(i&&(n+=byteLength(i)),t>0&&n>this._maxPayload)return this.writeBuffer.slice(0,t);n+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;let t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,v(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,n,i){return this._sendPacket("message",t,n,i),this}send(t,n,i){return this._sendPacket("message",t,n,i),this}_sendPacket(t,n,i,r){if("function"==typeof n&&(r=n,n=void 0),"function"==typeof i&&(r=i,i=null),"closing"===this.readyState||"closed"===this.readyState)return;(i=i||{}).compress=!1!==i.compress;let s={type:t,data:n,options:i};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),r&&this.once("flush",r),this.flush()}close(){let close=()=>{this._onClose("forced close"),this.transport.close()},cleanupAndClose=()=>{this.off("upgrade",cleanupAndClose),this.off("upgradeError",cleanupAndClose),close()},waitForUpgrade=()=>{this.once("upgrade",cleanupAndClose),this.once("upgradeError",cleanupAndClose)};return("opening"===this.readyState||"open"===this.readyState)&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?waitForUpgrade():close()}):this.upgrading?waitForUpgrade():close()),this}_onError(t){if(SocketWithoutUpgrade.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&"opening"===this.readyState)return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,n){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),q&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){let t=U.indexOf(this._offlineEventListener);-1!==t&&U.splice(t,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,n),this.writeBuffer=[],this._prevBufferLen=0}}};SocketWithoutUpgrade.protocol=4;let SocketWithUpgrade=class SocketWithUpgrade extends SocketWithoutUpgrade{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),"open"===this.readyState&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let n=this.createTransport(t),i=!1;SocketWithoutUpgrade.priorWebsocketSuccess=!1;let onTransportOpen=()=>{i||(n.send([{type:"ping",data:"probe"}]),n.once("packet",t=>{if(!i){if("pong"===t.type&&"probe"===t.data)this.upgrading=!0,this.emitReserved("upgrading",n),n&&(SocketWithoutUpgrade.priorWebsocketSuccess="websocket"===n.name,this.transport.pause(()=>{i||"closed"===this.readyState||(cleanup(),this.setTransport(n),n.send([{type:"upgrade"}]),this.emitReserved("upgrade",n),n=null,this.upgrading=!1,this.flush())}));else{let t=Error("probe error");t.transport=n.name,this.emitReserved("upgradeError",t)}}}))};function freezeTransport(){i||(i=!0,cleanup(),n.close(),n=null)}let onerror=t=>{let i=Error("probe error: "+t);i.transport=n.name,freezeTransport(),this.emitReserved("upgradeError",i)};function onTransportClose(){onerror("transport closed")}function onclose(){onerror("socket closed")}function onupgrade(t){n&&t.name!==n.name&&freezeTransport()}let cleanup=()=>{n.removeListener("open",onTransportOpen),n.removeListener("error",onerror),n.removeListener("close",onTransportClose),this.off("close",onclose),this.off("upgrading",onupgrade)};n.once("open",onTransportOpen),n.once("error",onerror),n.once("close",onTransportClose),this.once("close",onclose),this.once("upgrading",onupgrade),-1!==this._upgrades.indexOf("webtransport")&&"webtransport"!==t?this.setTimeoutFn(()=>{i||n.open()},200):n.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){let n=[];for(let i=0;i<t.length;i++)~this.transports.indexOf(t[i])&&n.push(t[i]);return n}};let Socket=class Socket extends SocketWithUpgrade{constructor(t,n={}){let i="object"==typeof t?t:n;(!i.transports||i.transports&&"string"==typeof i.transports[0])&&(i.transports=(i.transports||["polling","websocket","webtransport"]).map(t=>x[t]).filter(t=>!!t)),super(t,i)}};function url(t,n="",i){let r=t;i=i||"undefined"!=typeof location&&location,null==t&&(t=i.protocol+"//"+i.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?i.protocol+t:i.host+t),/^(https?|wss?):\/\//.test(t)||(t=void 0!==i?i.protocol+"//"+t:"https://"+t),r=parse(t)),!r.port&&(/^(http|ws)$/.test(r.protocol)?r.port="80":/^(http|ws)s$/.test(r.protocol)&&(r.port="443")),r.path=r.path||"/";let s=-1!==r.host.indexOf(":"),o=s?"["+r.host+"]":r.host;return r.id=r.protocol+"://"+o+":"+r.port+n,r.href=r.protocol+"://"+o+(i&&i.port===r.port?"":":"+r.port),r}Socket.protocol;let M="function"==typeof ArrayBuffer,is_binary_isView=t=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,D=Object.prototype.toString,I="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===D.call(Blob),W="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===D.call(File);function isBinary(t){return M&&(t instanceof ArrayBuffer||is_binary_isView(t))||I&&t instanceof Blob||W&&t instanceof File}function hasBinary(t,n){if(!t||"object"!=typeof t)return!1;if(Array.isArray(t)){for(let n=0,i=t.length;n<i;n++)if(hasBinary(t[n]))return!0;return!1}if(isBinary(t))return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1==arguments.length)return hasBinary(t.toJSON(),!0);for(let n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&hasBinary(t[n]))return!0;return!1}function deconstructPacket(t){let n=[],i=t.data;return t.data=_deconstructPacket(i,n),t.attachments=n.length,{packet:t,buffers:n}}function _deconstructPacket(t,n){if(!t)return t;if(isBinary(t)){let i={_placeholder:!0,num:n.length};return n.push(t),i}if(Array.isArray(t)){let i=Array(t.length);for(let r=0;r<t.length;r++)i[r]=_deconstructPacket(t[r],n);return i}if("object"==typeof t&&!(t instanceof Date)){let i={};for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&(i[r]=_deconstructPacket(t[r],n));return i}return t}function reconstructPacket(t,n){return t.data=_reconstructPacket(t.data,n),delete t.attachments,t}function _reconstructPacket(t,n){if(!t)return t;if(t&&!0===t._placeholder){let i="number"==typeof t.num&&t.num>=0&&t.num<n.length;if(i)return n[t.num];throw Error("illegal attachments")}if(Array.isArray(t))for(let i=0;i<t.length;i++)t[i]=_reconstructPacket(t[i],n);else if("object"==typeof t)for(let i in t)Object.prototype.hasOwnProperty.call(t,i)&&(t[i]=_reconstructPacket(t[i],n));return t}let H=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],V=5;(o=a||(a={}))[o.CONNECT=0]="CONNECT",o[o.DISCONNECT=1]="DISCONNECT",o[o.EVENT=2]="EVENT",o[o.ACK=3]="ACK",o[o.CONNECT_ERROR=4]="CONNECT_ERROR",o[o.BINARY_EVENT=5]="BINARY_EVENT",o[o.BINARY_ACK=6]="BINARY_ACK";let Encoder=class Encoder{constructor(t){this.replacer=t}encode(t){return(t.type===a.EVENT||t.type===a.ACK)&&hasBinary(t)?this.encodeAsBinary({type:t.type===a.EVENT?a.BINARY_EVENT:a.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let n=""+t.type;return(t.type===a.BINARY_EVENT||t.type===a.BINARY_ACK)&&(n+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(n+=t.nsp+","),null!=t.id&&(n+=t.id),null!=t.data&&(n+=JSON.stringify(t.data,this.replacer)),n}encodeAsBinary(t){let n=deconstructPacket(t),i=this.encodeAsString(n.packet),r=n.buffers;return r.unshift(i),r}};function isObject(t){return"[object Object]"===Object.prototype.toString.call(t)}let Decoder=class Decoder extends Emitter{constructor(t){super(),this.reviver=t}add(t){let n;if("string"==typeof t){if(this.reconstructor)throw Error("got plaintext data when reconstructing a packet");n=this.decodeString(t);let i=n.type===a.BINARY_EVENT;i||n.type===a.BINARY_ACK?(n.type=i?a.EVENT:a.ACK,this.reconstructor=new BinaryReconstructor(n),0===n.attachments&&super.emitReserved("decoded",n)):super.emitReserved("decoded",n)}else if(isBinary(t)||t.base64){if(this.reconstructor)(n=this.reconstructor.takeBinaryData(t))&&(this.reconstructor=null,super.emitReserved("decoded",n));else throw Error("got binary data when not reconstructing a packet")}else throw Error("Unknown type: "+t)}decodeString(t){let n=0,i={type:Number(t.charAt(0))};if(void 0===a[i.type])throw Error("unknown packet type "+i.type);if(i.type===a.BINARY_EVENT||i.type===a.BINARY_ACK){let r=n+1;for(;"-"!==t.charAt(++n)&&n!=t.length;);let s=t.substring(r,n);if(s!=Number(s)||"-"!==t.charAt(n))throw Error("Illegal attachments");i.attachments=Number(s)}if("/"===t.charAt(n+1)){let r=n+1;for(;++n;){let i=t.charAt(n);if(","===i||n===t.length)break}i.nsp=t.substring(r,n)}else i.nsp="/";let r=t.charAt(n+1);if(""!==r&&Number(r)==r){let r=n+1;for(;++n;){let i=t.charAt(n);if(null==i||Number(i)!=i){--n;break}if(n===t.length)break}i.id=Number(t.substring(r,n+1))}if(t.charAt(++n)){let r=this.tryParse(t.substr(n));if(Decoder.isPayloadValid(i.type,r))i.data=r;else throw Error("invalid payload")}return i}tryParse(t){try{return JSON.parse(t,this.reviver)}catch(t){return!1}}static isPayloadValid(t,n){switch(t){case a.CONNECT:return isObject(n);case a.DISCONNECT:return void 0===n;case a.CONNECT_ERROR:return"string"==typeof n||isObject(n);case a.EVENT:case a.BINARY_EVENT:return Array.isArray(n)&&("number"==typeof n[0]||"string"==typeof n[0]&&-1===H.indexOf(n[0]));case a.ACK:case a.BINARY_ACK:return Array.isArray(n)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}};let BinaryReconstructor=class BinaryReconstructor{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){let t=reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}};function on(t,n,i){return t.on(n,i),function(){t.off(n,i)}}let z=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});let socket_Socket=class socket_Socket extends Emitter{constructor(t,n,i){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=n,i&&i.auth&&(this.auth=i.auth),this._opts=Object.assign({},i),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let t=this.io;this.subs=[on(t,"open",this.onopen.bind(this)),on(t,"packet",this.onpacket.bind(this)),on(t,"error",this.onerror.bind(this)),on(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...n){var i,r,s;if(z.hasOwnProperty(t))throw Error('"'+t.toString()+'" is a reserved event name');if(n.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(n),this;let o={type:a.EVENT,data:n};if(o.options={},o.options.compress=!1!==this.flags.compress,"function"==typeof n[n.length-1]){let t=this.ids++,i=n.pop();this._registerAckCallback(t,i),o.id=t}let h=null===(r=null===(i=this.io.engine)||void 0===i?void 0:i.transport)||void 0===r?void 0:r.writable,u=this.connected&&!(null===(s=this.io.engine)||void 0===s?void 0:s._hasPingExpired()),l=this.flags.volatile&&!h;return l||(u?(this.notifyOutgoingListeners(o),this.packet(o)):this.sendBuffer.push(o)),this.flags={},this}_registerAckCallback(t,n){var i;let r=null!==(i=this.flags.timeout)&&void 0!==i?i:this._opts.ackTimeout;if(void 0===r){this.acks[t]=n;return}let s=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let n=0;n<this.sendBuffer.length;n++)this.sendBuffer[n].id===t&&this.sendBuffer.splice(n,1);n.call(this,Error("operation has timed out"))},r),fn=(...t)=>{this.io.clearTimeoutFn(s),n.apply(this,t)};fn.withError=!0,this.acks[t]=fn}emitWithAck(t,...n){return new Promise((i,r)=>{let fn=(t,n)=>t?r(t):i(n);fn.withError=!0,n.push(fn),this.emit(t,...n)})}_addToQueue(t){let n;"function"==typeof t[t.length-1]&&(n=t.pop());let i={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((t,...r)=>{if(i!==this._queue[0])return;let s=null!==t;return s?i.tryCount>this._opts.retries&&(this._queue.shift(),n&&n(t)):(this._queue.shift(),n&&n(null,...r)),i.pending=!1,this._drainQueue()}),this._queue.push(i),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||0===this._queue.length)return;let n=this._queue[0];(!n.pending||t)&&(n.pending=!0,n.tryCount++,this.flags=n.flags,this.emit.apply(this,n.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){"function"==typeof this.auth?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:a.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,n){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,n),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{let n=this.sendBuffer.some(n=>String(n.id)===t);if(!n){let n=this.acks[t];delete this.acks[t],n.withError&&n.call(this,Error("socket has been disconnected"))}})}onpacket(t){let n=t.nsp===this.nsp;if(n)switch(t.type){case a.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case a.EVENT:case a.BINARY_EVENT:this.onevent(t);break;case a.ACK:case a.BINARY_ACK:this.onack(t);break;case a.DISCONNECT:this.ondisconnect();break;case a.CONNECT_ERROR:this.destroy();let i=Error(t.data.message);i.data=t.data.data,this.emitReserved("connect_error",i)}}onevent(t){let n=t.data||[];null!=t.id&&n.push(this.ack(t.id)),this.connected?this.emitEvent(n):this.receiveBuffer.push(Object.freeze(n))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){let n=this._anyListeners.slice();for(let i of n)i.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&"string"==typeof t[t.length-1]&&(this._lastOffset=t[t.length-1])}ack(t){let n=this,i=!1;return function(...r){i||(i=!0,n.packet({type:a.ACK,id:t,data:r}))}}onack(t){let n=this.acks[t.id];"function"==typeof n&&(delete this.acks[t.id],n.withError&&t.data.unshift(null),n.apply(this,t.data))}onconnect(t,n){this.id=t,this.recovered=n&&this._pid===n,this._pid=n,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:a.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){let n=this._anyListeners;for(let i=0;i<n.length;i++)if(t===n[i]){n.splice(i,1);break}}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){let n=this._anyOutgoingListeners;for(let i=0;i<n.length;i++)if(t===n[i]){n.splice(i,1);break}}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){let n=this._anyOutgoingListeners.slice();for(let i of n)i.apply(this,t.data)}}};function Backoff(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}Backoff.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var n=Math.random(),i=Math.floor(n*this.jitter*t);t=(1&Math.floor(10*n))==0?t-i:t+i}return 0|Math.min(t,this.max)},Backoff.prototype.reset=function(){this.attempts=0},Backoff.prototype.setMin=function(t){this.ms=t},Backoff.prototype.setMax=function(t){this.max=t},Backoff.prototype.setJitter=function(t){this.jitter=t};let Manager=class Manager extends Emitter{constructor(t,n){var i;super(),this.nsps={},this.subs=[],t&&"object"==typeof t&&(n=t,t=void 0),(n=n||{}).path=n.path||"/socket.io",this.opts=n,installTimerFunctions(this,n),this.reconnection(!1!==n.reconnection),this.reconnectionAttempts(n.reconnectionAttempts||1/0),this.reconnectionDelay(n.reconnectionDelay||1e3),this.reconnectionDelayMax(n.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(i=n.randomizationFactor)&&void 0!==i?i:.5),this.backoff=new Backoff({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==n.timeout?2e4:n.timeout),this._readyState="closed",this.uri=t;let r=n.parser||h;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=!1!==n.autoConnect,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var n;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(n=this.backoff)||void 0===n||n.setMin(t),this)}randomizationFactor(t){var n;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(n=this.backoff)||void 0===n||n.setJitter(t),this)}reconnectionDelayMax(t){var n;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(n=this.backoff)||void 0===n||n.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Socket(this.uri,this.opts);let n=this.engine,i=this;this._readyState="opening",this.skipReconnect=!1;let r=on(n,"open",function(){i.onopen(),t&&t()}),onError=n=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",n),t?t(n):this.maybeReconnectOnOpen()},s=on(n,"error",onError);if(!1!==this._timeout){let t=this._timeout,i=this.setTimeoutFn(()=>{r(),onError(Error("timeout")),n.close()},t);this.opts.autoUnref&&i.unref(),this.subs.push(()=>{this.clearTimeoutFn(i)})}return this.subs.push(r),this.subs.push(s),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");let t=this.engine;this.subs.push(on(t,"ping",this.onping.bind(this)),on(t,"data",this.ondata.bind(this)),on(t,"error",this.onerror.bind(this)),on(t,"close",this.onclose.bind(this)),on(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(t){this.onclose("parse error",t)}}ondecoded(t){v(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,n){let i=this.nsps[t];return i?this._autoConnect&&!i.active&&i.connect():(i=new socket_Socket(this,t,n),this.nsps[t]=i),i}_destroy(t){let n=Object.keys(this.nsps);for(let t of n){let n=this.nsps[t];if(n.active)return}this._close()}_packet(t){let n=this.encoder.encode(t);for(let i=0;i<n.length;i++)this.engine.write(n[i],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,n){var i;this.cleanup(),null===(i=this.engine)||void 0===i||i.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,n),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let n=this.backoff.duration();this._reconnecting=!0;let i=this.setTimeoutFn(()=>{!t.skipReconnect&&(this.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open(n=>{n?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",n)):t.onreconnect()}))},n);this.opts.autoUnref&&i.unref(),this.subs.push(()=>{this.clearTimeoutFn(i)})}}onreconnect(){let t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}};let $={};function esm_lookup(t,n){let i;"object"==typeof t&&(n=t,t=void 0),n=n||{};let r=url(t,n.path||"/socket.io"),s=r.source,o=r.id,a=r.path,h=$[o]&&a in $[o].nsps,u=n.forceNew||n["force new connection"]||!1===n.multiplex||h;return u?i=new Manager(s,n):($[o]||($[o]=new Manager(s,n)),i=$[o]),r.query&&!n.query&&(n.query=r.queryKey),i.socket(r.path,n)}Object.assign(esm_lookup,{Manager:Manager,Socket:socket_Socket,io:esm_lookup,connect:esm_lookup})}}]);